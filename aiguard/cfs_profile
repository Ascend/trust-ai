#include <tunables/golbal>

profile cfs_profile flags=((attach_disconnected,mediate_deleted){
	#include <abstractions/base>

	network,
	capability,
	file,
	umount,
	mount,
	ptrace,

	deny @{PROC} /* w,
	//deny write to files not in /proc/<number>/** or /proc/sys/**
	deny @{PROC} /{[^1-9],[^1-9][^0-9],[^1-9s][^0-9y][^0-9s],[^1-9][^0-9][^0-9][^0-9]*} /** w,
	deny @{PROC} /sys/[^k]** w,
	deny @{PROC} /sys/kernel/{?,??,[^s][^h][^m]**} w,
	deny @{PROC} /syssrq-trigger rwklx,
	deny @{PROC} /kcore rwklx,

	deny /sys/[^f]*/** wklx,
	deny /sys/f[^s]*/** wklx,
	deny /sys/[^c]*/** wklx,
	deny /sys/c[^g]*/** wklx,
	deny /sys/cg[^r]*/** wklx,
	deny /sys/firmware/** rwklx,
	deny /sys/kernel/security/** rwklx,
})